<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>源码 | 资料整理</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.67967071.css" as="style"><link rel="preload" href="/assets/js/app.65e7af1e.js" as="script"><link rel="preload" href="/assets/js/2.8e8343f9.js" as="script"><link rel="preload" href="/assets/js/19.39cef109.js" as="script"><link rel="prefetch" href="/assets/js/10.e3709308.js"><link rel="prefetch" href="/assets/js/11.92c21dd8.js"><link rel="prefetch" href="/assets/js/12.063b04b6.js"><link rel="prefetch" href="/assets/js/13.bd29dce9.js"><link rel="prefetch" href="/assets/js/14.61725a04.js"><link rel="prefetch" href="/assets/js/15.ee277a9b.js"><link rel="prefetch" href="/assets/js/16.6ebabfb2.js"><link rel="prefetch" href="/assets/js/17.a00c58d0.js"><link rel="prefetch" href="/assets/js/18.cb335336.js"><link rel="prefetch" href="/assets/js/20.d4311a21.js"><link rel="prefetch" href="/assets/js/21.1d15e296.js"><link rel="prefetch" href="/assets/js/3.2aadfa07.js"><link rel="prefetch" href="/assets/js/4.d9354908.js"><link rel="prefetch" href="/assets/js/5.16e1a249.js"><link rel="prefetch" href="/assets/js/6.e01a5301.js"><link rel="prefetch" href="/assets/js/7.4a2acddb.js"><link rel="prefetch" href="/assets/js/8.efc01769.js"><link rel="prefetch" href="/assets/js/9.9b130e8a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.67967071.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">资料整理</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/html/" class="sidebar-link">html</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/es6/" class="sidebar-link">es6</a></li><li><a href="/css/" class="sidebar-link">css</a></li><li><a href="/angular/" class="sidebar-link">angular</a></li><li><a href="/rxjs/" class="sidebar-link">rxjs</a></li><li><a href="/git/" class="sidebar-link">git</a></li><li><a href="/webpack/" class="sidebar-link">webpack,gulp,grunt</a></li><li><a href="/gof/" class="sidebar-link">design patterns</a></li><li><a href="/nodejs/" class="sidebar-link">nodejs</a></li><li><a href="/linux/base.html" class="sidebar-link">shell</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/base.html" class="sidebar-link">基础</a></li><li><a href="/vue/code.html" class="active sidebar-link">源码</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="package-json"><a href="#package-json" class="header-anchor">#</a> package.json</h3> <p>web-full-dev</p> <h3 id="scirpts-config-js"><a href="#scirpts-config-js" class="header-anchor">#</a> scirpts/config.js</h3> <h3 id="src-platforms-web-entry-runtime-with-compiler-js"><a href="#src-platforms-web-entry-runtime-with-compiler-js" class="header-anchor">#</a> src/platforms/web/entry-runtime-with-compiler.js</h3> <p>cached  闭包用来缓存函数结果,只计算一次<br>
template-&gt;options.render = render, options.staticRenderFns = staticRenderFns-&gt;mount.call(this, el, hydrating)</p> <h3 id="src-platforms-web-runtime-index"><a href="#src-platforms-web-runtime-index" class="header-anchor">#</a> src/platforms/web/runtime/index</h3> <p>Vue.prototype.<strong>patch</strong> =patch<br>
Vue.prototype.$mount-&gt;mountComponent(this, el, hydrating)</p> <h3 id="src-core-index"><a href="#src-core-index" class="header-anchor">#</a> src/core/index</h3> <p>initGlobalAPI(Vue),挂载了几个变量,$isServer,<strong>VERSION</strong>,$ssrContext,FunctionalRenderContext</p> <h3 id="src-core-instance-index"><a href="#src-core-instance-index" class="header-anchor">#</a> src/core/instance/index</h3> <p>声明Vue,执行this._init(options),原型对象挂载各种方法init,state,events,lifecycle,render,<br>
先执行init,在执行mountComponent</p> <h3 id="src-core-instance-init"><a href="#src-core-instance-init" class="header-anchor">#</a> src/core/instance/init</h3> <p>initGlobalAPI&gt;/global-api/index&gt;声明Vue.options,</p> <div class="language-js extra-class"><pre class="language-js"><code>   vm<span class="token punctuation">.</span>$options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>
   mergeOptions
   resolveConstructorOptions<span class="token punctuation">)</span>
</code></pre></div><p>构造子类的时候,Vue.extend方法会为Ctor添加一个super属性，指向其父类构造器</p> <h5 id="构造函数上的options来源"><a href="#构造函数上的options来源" class="header-anchor">#</a> 构造函数上的options来源</h5> <ul><li>./runtime/index中<br>
Vue.options.directives添加model,show属性<br>
Vue.options.components添加Transition,TransitionGroup属性
*/global-api/index 中<br>
创建Vue.options以及给components中增加KeepAlive,给options增加filters,_base属性<br>
如果父类的options改变,则把自身的superOptions替换为最新的,<br>
如果自身的options改变,则把新添加的options属性添加到Ctor.extendOptions属性上,并调用mergeOptions<br>
合并superOptions和extendOptions,最后返回合并的options</li></ul> <h5 id="mergeoptions合并策略"><a href="#mergeoptions合并策略" class="header-anchor">#</a> mergeOptions合并策略</h5> <ul><li>normalizeProps  props转化为对象</li> <li>normalizeInject  inject属性转化为对象</li> <li>normalizeDirectives  自定义指令转化为对象的形式<br>
mergeoptions方法是要合并构造函数options和传入的options这两个对象<br>
当传入的options里有mixin或者extends属性时，调用mergeOptions方法合并mixins和extends里的内容到实例的构造函数options</li></ul> <h5 id="钩子函数的策略"><a href="#钩子函数的策略" class="header-anchor">#</a> 钩子函数的策略</h5> <ol><li>child options上不存在该属性，parent options上存在,则返回parent上的属性。</li> <li>child和parent都存在该属性，则返回concat之后的属性</li> <li>child上存在该属性，parent不存在，且child上的该属性是Array，则直接返回child上的该属性,不是Array，则把该属性先转换成Array,再返回。</li></ol> <h5 id="props-methods-inject-computed的策略"><a href="#props-methods-inject-computed的策略" class="header-anchor">#</a> props/methods/inject/computed的策略</h5> <ol><li>如果parent options上没有该属性，则直接返回child options上的该属性</li> <li>如果parent options和child options都有，则合并parent options和child options并生成一个新的对象。(如果parent和child上有同名属性，合并后的以child options上的为准)</li></ol> <h5 id="components-directives-filters的合并策略"><a href="#components-directives-filters的合并策略" class="header-anchor">#</a> components/directives/filters的合并策略</h5> <p>和上一种情况的类似</p> <h5 id="data和provide的策略"><a href="#data和provide的策略" class="header-anchor">#</a> data和provide的策略</h5> <p>第一种情况，当前调用mergeOptions操作的是vm实例（调用new新建vue实例触发mergeOptions方法）,如果新建实例时传入的options上有data属性，<br>
则调用mergeData方法合并实例上的data属性和其构造函数options上的data属性<br>
第二种情况，当前调用mergeOptions操作的不是vm实例（即通过Vue.extend/Vue.component调用了mergeOptions方法）<br>
如果当前实例options或者构造函数options上有一个没有data属性，则返回另一个的data属性，如果两者都有，则同样调用   mergeData方法处理合并。<br>
mergeData的逻辑是,如果child上没有,把parent中的添加到child上,如果都是对象,递归调用mergeData</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue/base.html" class="prev">基础</a></span> <!----></p></div> </main></div><div class="global-ui"><div class="container" data-v-0178ff65><canvas id="live2d" width="280" height="250" class="live2d-right" data-v-0178ff65></canvas></div></div></div>
    <script src="/assets/js/app.65e7af1e.js" defer></script><script src="/assets/js/2.8e8343f9.js" defer></script><script src="/assets/js/19.39cef109.js" defer></script>
  </body>
</html>
